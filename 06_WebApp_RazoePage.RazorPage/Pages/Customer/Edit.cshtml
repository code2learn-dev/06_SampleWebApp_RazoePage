@page "{id?}"
@model _06_WebApp_RazoePage.RazorPage.Pages.Customer.EditModel
@{
	ViewBag.Title = "ویرایش مشتری";
	ViewBag.CssTitle = "suucess";
	LinkViewModel linkViewModel = new()
	{
		Caption = "لیست مشتریان",
		PageName = "Index",
		ButtonCaption = "ذخیره",
		ButtonCssClass = "success"
	};

	string profileImage = string.Empty;
	if (TempData.ContainsKey("ProfileImage"))
		profileImage = TempData["ProfileImage"]?.ToString() ?? string.Empty;
}
@section styles {
	<link href="~/css/customer.style.css" rel="stylesheet" />
}
<form method="post" enctype="multipart/form-data">
	<input type="hidden" value="@profileImage" id="profile-image" />
	<input type="hidden" asp-for="CrudEntityViewModel.Id" />
	<input type="hidden" asp-for="CrudEntityViewModel.ProfileImage" />
	<section class="row">
		<aside class="col-md-4">
			<article class="card customer-image-container">
				<div class="customer-image-section">
					<img id="customer-image" src="@profileImage" class="img-thumbnail" />
				</div>
				<div class="text-center customer-image-buttons">
					<a class="btn btn-success btn-sm" id="select-image">
						<i class="bi bi-arrow-right-circle"></i>
						انتخاب تصویر
					</a>
					<a class="btn btn-danger btn-sm" id="clear-image">
						<i class="bi bi-x-square"></i> 
					</a>
					<input type="file" asp-for="CrudEntityViewModel.File" accept=".png, .jpg, .jpeg" id="input-file" />
				</div>
			</article>
			<p class="alert alert-danger mt-1 p-2 text-center">حجم فایل انتخابی حداکثر 10 مگابایت</p>
			<p class="alert alert-danger mt-1 p-2 text-center">تنها فرمت های jpg  و png مجاز است</p>
		</aside>
		<aside class="col-md-8">
			<div class="mt-2">
				<label asp-for="CrudEntityViewModel.FirstName"></label>
				<input asp-for="CrudEntityViewModel.FirstName" class="form-control" />
				<span class="text-danger" asp-validation-for="CrudEntityViewModel.FirstName"></span>
			</div>
			<div class="mt-2">
				<label asp-for="CrudEntityViewModel.LastName"></label>
				<input asp-for="CrudEntityViewModel.LastName" class="form-control" />
				<span class="text-danger" asp-validation-for="CrudEntityViewModel.LastName"></span>
			</div>
			<div class="mt-2">
				<label asp-for="CrudEntityViewModel.NationalCode"></label>
				<input asp-for="CrudEntityViewModel.NationalCode" class="form-control" />
				<span class="text-danger" asp-validation-for="CrudEntityViewModel.NationalCode"></span>
			</div>
			<div class="mt-2">
				<label asp-for="CrudEntityViewModel.PhoneNumber"></label>
				<input asp-for="CrudEntityViewModel.PhoneNumber" class="form-control" />
				<span class="text-danger" asp-validation-for="CrudEntityViewModel.PhoneNumber"></span>
			</div>
		</aside>
	</section>
	<partial name="LinkView" model="@linkViewModel" />
</form>
@section scripts {
	<script src="~/scripts/customer.script.js"></script>
	<script>
		$(function () {
			let imageProfile = $('#profile-image').val();
			let $clrbtn = $('#clear-image');
			if (imageProfile !== null) {
				$('#customer-image').fadeIn();
				$('#clear-image').html('<i class="bi bi-x-square"></i> تصویر اولیه');
			}
			else {
				$('#clear-image').html('<i class="bi bi-x-square"></i> حذف تصویر');
			}

			$clrbtn.on('click', () => {   
				setTimeout(() => {
					$('#customer-image').attr('src', imageProfile);
					$('#customer-image').fadeIn();
				}, 400);
			});
			 
		});
	</script>
}